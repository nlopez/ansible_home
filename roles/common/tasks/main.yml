---
- name: Ensure the router solicitation daemon is running and enabled
  service: name=rtsold state=started enabled=yes
  when: ansible_os_family == "FreeBSD"

- name: Set locale to en_us.UTF-8
  copy: src=login.conf dest=/etc/login.conf owner=root group=wheel mode=0644
  notify: rebuild capabilities database for login.conf
  when: ansible_os_family == "FreeBSD"

- name: Set locale to en_us.UTF-8
  copy: src=locale.gen dest=/etc/locale.gen owner=root group=root mode=0644
  notify: generate locales
  when: ansible_os_family == "Archlinux"

- name: Install common packages
  package: name=bash,sudo,rsync,{{ system_certificates }},curl,wget,mosh,screen,bind-tools,tree,{{ vim }} state=present

- name: Set root's shell to bash
  user: name=root shell={{ bash_binary }}

- name: Add Nick's group
  group: name=nlopez state=present

- name: Add Nick's superuser
  user:
    name: nlopez
    shell: "{{ bash_binary }}"
    group: nlopez
    groups: wheel
    createhome: True

- name: Setup Nick's keys
  authorized_key: user=nlopez key="{{ item }}" state=present
  with_file:
    - public_keys/nlopez

- name: Allow members of group wheel to run all commands without a password
  copy: src=sudoers dest={{ sudoers }} validate='visudo -cf %s'
